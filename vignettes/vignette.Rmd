---
title: "ProteomicsTools"
author: "David Nathan Ohayon"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    fig_caption: yes
vignette: >
  %\VignetteIndexEntry{ProteomicsTools}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, include=FALSE}
library(ProteomicsTools)
library(DT)
```

# Introduction
![Logo](../data/UNIGE.png){width=200px height=100px style="position: absolute; top: 20px; left: 900px;"}
Welcome to the **ProteomicsTools** vignette! This vignette provides an introduction to the installation, functionality and usage of the package.


## Package Overview

**ProteomicsTools** is designed to help Proteomics researches, especially to compare methods of protein extraction. Various analytics and visualization tools are provided in order to compare 5 methods of extraction. 

## Installation 

To install this package, you must first install various packages, including packages from Bioconductor. The first step is to install BiocManager with:

```{r}
# installation of BiocManager in order to install Bioconductor packages:
if (!require("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
```

### Installation of Bioconductor packages:
```{r, eval=FALSE}
BiocManager::install("ComplexHeatmap")
BiocManager::install("limma")
BiocManager::install("edgeR")
```

### Installation of CRAN packages:
```{r, eval=FALSE}
install.packages("dplyr")
install.packages("ggplot2")
install.packages("ggvenn")
install.packages("reshape2")
install.packages("rlang")
install.packages("tidyr")
install.packages("stats")
```

### Installation of the package.tar.gz
```{r, eval=FALSE}
install.packages("~/path/ProteomicsTools_version.tar.gz", repos = NULL, type = "source")
```

## Context of the package {.flexbox .vcenter}

- Question:
  - Is there a bias between one given method and one given protein ?
- 5 methods of proteomic extraction in order to compare those methods:
  - RIPA
  - NucleoSpin
  - Tris.HCl
  - Triton.X100
  - Urea
- The same cell has been lysed with those methods (a human melanoma cell line [G-361])
- Protein abundance have been estimated using MS technology
  - Goals of the package:
    - Analyze proteomic data
    - Compare methods of extraction
    - Visualization tools

## Data preparation


### Protein Abundances Table

To use the package, your table must be in a certain format: 

- Gene names (or other ID) must be in the first column
- Column names must be the method of extraction. 
- The separation between the method and the replicates should be an underscore. 
- Values should be Log2 of the Protein abundance

```{r, echo=FALSE}
# example table
datatable(log2, options = list(scrollX = TRUE, scrollY = "350px"))
```

---

### Mined data
For this table, it is important that the identifier is the same than the first table.

Also, mined data should be stored into numeric/integer values, including 0. Functions will then transform this table into logical variable, 0 being FALSE and integer/numeric values being TRUE.

```{r, echo=FALSE}
datatable(big, options = list(scrollX = TRUE, scrollY = "350px"))
```

## Usage



- MultiDimensional Scaling Plot (visualization tool)

```{r, echo = TRUE, highlight=FALSE, warning=FALSE, message=FALSE, fig.width=12, fig.height=5, dpi=72}
myMDSplot(log2)
```

---

-Heatmap of the log2 data
<div style="height: 470px; overflow: scroll;">
```{r, echo = TRUE, highlight=FALSE, warning=FALSE, message=FALSE, fig.width=13, fig.height=200, dpi=72}
library(ProteomicsTools)
heatmap_maker(log2[,-1])
```
</div>

---

- Internal Function to create the replicate variable

```{r, echo=FALSE, warning=FALSE, message=FALSE}
datatable(replicates_factor(log2), options = list(scrollX = TRUE, scrollY = "350px"))
```

---

- Internal Function: change numeric p-value into logical 

```{r}
datatable(reformat_table(ttest), options = list(scrollX = TRUE, scrollY = "350px"))
```

---

- Internal Function to correct pairs of methods

```{r, echo=FALSE, warning=FALSE, message=FALSE}
datatable(col_sorted(ttest), options = list(scrollX = TRUE, scrollY = "350px"))
```

---

- Internal Function: Computes mean of the replicates 

```{r, echo=FALSE, warning=FALSE, message=FALSE}
datatable(mean_function(log2), options = list(scrollX = TRUE, scrollY = "350px"))
```


---

Most useful functions:

- mypairwise_t() will compute pairwise t-test for each pairs of methods.
```{r, echo=FALSE}
datatable(ttest, options = list(scrollX = TRUE, scrollY = "350px"))
```

---


- myfoldchange() will compute pairwise foldchange for each pairs of methods
```{r, echo=FALSE}
datatable(foldc, options = list(scrollX = TRUE, scrollY = "350px"))
```


---

- fishertest() will compute enrichment analysis for each pairs of methods with one of your mined data
```{r, echo=FALSE}
datatable(ftest, options = list(scrollX = TRUE, scrollY = "350px"))
```


---


- volcano_all() will compute volcano plots for your data

<div style="height: 470px; overflow: scroll;">
```{r, echo = TRUE, highlight=FALSE, warning=FALSE, message=FALSE, fig.width=40, fig.height=5, dpi=72}
volcano_all(ttest, foldc, big, "TMregions", path = "../examples/")
```
</div>

---

- Isolate volcano plot

```{r, echo = TRUE, highlight=FALSE, warning=FALSE, message=FALSE, fig.height=4}
volcano_maker(ttest, foldc, big, "TMregions", path = "../examples/")
```

---

- This enrichment can be seen with fisher_dotplot()
```{r, echo = TRUE, highlight=FALSE, fig.width=10, fig.height=5.2}
fisher_dotplot(ftest, path = "../examples/")
```

---

For other informations about functions in general, you can check helping page and/or watch the rmarkdown slides inside "~/vignettes". Output are saved inside "~/examples".
Enjoy!
